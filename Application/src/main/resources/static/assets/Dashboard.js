import{_ as p}from"./index.js";import{r as n,c as R,w as $,y as S,A as s,K as t,F as i,B as d,C as A,R as a,N as _,Q as m,s as b,q as g,v as y,l as r}from"./main.js";const V={class:"flex h-screen bg-background text-foreground"},P={class:"hidden h-full w-72 flex-col border-r border-border/60 bg-muted/30 px-4 py-6 md:flex"},E={class:"mt-6 flex-1 space-y-2 overflow-y-auto pr-2"},F=["onClick"],H={class:"text-sm font-medium leading-tight"},q={key:0,class:"text-xs text-muted-foreground/80"},K={class:"border-t border-border/50 pt-4"},Q={class:"relative"},Y={key:0,class:"absolute bottom-14 left-0 w-full rounded-xl border border-border/50 bg-background/95 shadow-lg backdrop-blur"},G=["disabled"],I={class:"flex flex-1 flex-col overflow-hidden bg-background"},J={class:"border-b border-border/60 bg-background/80 px-6 py-5 backdrop-blur lg:px-10"},W={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between"},X={class:"flex items-center gap-2 text-xs text-muted-foreground"},Z={key:0,class:"mt-3 text-xs text-destructive"},ee={class:"relative flex flex-1 flex-col overflow-hidden"},te={class:"flex-1 overflow-y-auto px-6 py-6 lg:px-10"},oe={class:"mx-auto w-full max-w-4xl space-y-6"},se={class:"text-xs uppercase tracking-[0.3em] text-muted-foreground/80"},re={class:"ml-2 text-muted-foreground/60"},le={class:"mt-3 space-y-3 text-sm leading-relaxed"},ae={key:0,class:"text-sm font-semibold text-foreground"},ne={key:1,class:"space-y-3"},de={key:2,class:"text-muted-foreground"},ie={key:3,class:"text-muted-foreground/70"},ue={key:1,class:"rounded-2xl border border-dashed border-border/70 px-4 py-10 text-center text-sm text-muted-foreground"},ce={class:"border-t border-border/60 bg-background/95 px-6 py-5 lg:px-10"},me={class:"mx-auto flex w-full max-w-4xl items-end gap-3 rounded-2xl border border-border/70 bg-background/80 px-4 py-3 shadow-sm"},fe={key:0,class:"mx-auto mt-3 w-full max-w-4xl rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive"},xe={key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur-sm"},ve={class:"w-full max-w-sm rounded-2xl border border-border bg-background p-6 shadow-xl"},pe={class:"flex items-start justify-between gap-3"},be={class:"mt-4 space-y-2"},he={__name:"Dashboard",props:{user:{type:Object,default:()=>({})}},setup(N){const z=N,h=n(!1),f=n(""),x=n(!1),u=n(null),k=n([]),C=n([]),c=n(!1),v=n(""),w=n(!0),M=R(()=>{const{firstName:l,lastName:e,email:o}=z.user??{};return l||e?[l,e].filter(Boolean).join(" ").trim()||"Traveler":o??"Traveler"});$(k,l=>{if(!l||l.length===0){u.value=null;return}l.find(o=>o.id===u.value)||(u.value=l[0]?.id??null)},{immediate:!0});async function U(){w.value=!0,v.value="";try{const l=await fetch("/api/dashboard",{credentials:"same-origin"});if(!l.ok){v.value="Unable to fetch dashboard data.";return}const e=await l.json().catch(()=>({}));k.value=Array.isArray(e.previousRecommendations)?e.previousRecommendations:[],C.value=Array.isArray(e.chatMessages)?e.chatMessages:[]}catch{v.value="Unexpected error loading dashboard."}finally{w.value=!1}}S(()=>{U()});function L(){x.value=!x.value}function T(){x.value=!1}function D(){T(),window.location.href="/settings"}async function B(){if(!h.value){f.value="",h.value=!0;try{const l=await fetch("/logout",{method:"POST",credentials:"same-origin"}),e=await l.json().catch(()=>({}));if(!l.ok){f.value=e?.message??"Unable to log out.";return}window.location.href="/"}catch{f.value="Unexpected error. Please try again."}finally{h.value=!1}}}return(l,e)=>(r(),s("div",V,[t("aside",P,[e[9]||(e[9]=t("div",null,[t("p",{class:"text-xs uppercase tracking-[0.4em] text-muted-foreground"},"Trips"),t("h2",{class:"mt-2 font-semibold text-foreground"},"Previous recommendations")],-1)),t("nav",E,[w.value?(r(),s(i,{key:0},[e[5]||(e[5]=t("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1)),e[6]||(e[6]=t("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1)),e[7]||(e[7]=t("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1))],64)):(r(),s(i,{key:1},[(r(!0),s(i,null,A(k.value,o=>(r(),s("button",{key:o.id||o.title,onClick:j=>u.value=o.id,class:_(["w-full rounded-xl px-3 py-3 text-left transition-all",u.value===o.id?"bg-primary text-primary-foreground shadow-sm":"bg-background/80 text-muted-foreground hover:bg-muted/60 hover:text-foreground"])},[t("p",H,a(o.title??"Untitled"),1),t("p",{class:_(["mt-1 text-xs",u.value===o.id?"text-primary-foreground/80":"text-muted-foreground/80"])},a(o.subtitle??"No metadata available"),3)],10,F))),128)),k.value.length?d("",!0):(r(),s("p",q," No recommendations yet. They will appear here once generated. "))],64))]),t("div",K,[t("div",Q,[t("button",{class:"flex w-full items-center justify-between rounded-xl bg-background/80 px-3 py-3 text-sm font-medium text-foreground transition hover:bg-muted",onClick:L},[t("span",null,a(M.value),1),(r(),s("svg",{class:_(["size-4 text-muted-foreground transition-transform",x.value?"rotate-180":""]),viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[...e[8]||(e[8]=[t("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"},null,-1)])],2))]),x.value?(r(),s("div",Y,[t("button",{class:"w-full px-4 py-2 text-left text-sm text-muted-foreground hover:bg-muted/70 hover:text-foreground",onClick:D}," Settings "),t("button",{class:"w-full px-4 py-2 text-left text-sm text-destructive hover:bg-destructive/10",onClick:B,disabled:h.value}," Sign out ",8,G)])):d("",!0)])])]),t("main",I,[t("header",J,[t("div",W,[e[11]||(e[11]=t("div",null,[t("h1",{class:"text-xl font-semibold tracking-tight sm:text-2xl"}," Travel Recommendation Dashboard "),t("p",{class:"text-sm text-muted-foreground"}," Overview of the Travel Recommendation project and generated trips. ")],-1)),t("div",X,[e[10]||(e[10]=t("span",{class:"rounded-full bg-emerald-500/10 px-2 py-1 text-emerald-500"},"Online",-1)),m(" "+a(new Date().toLocaleDateString()),1)])]),v.value?(r(),s("p",Z,a(v.value),1)):d("",!0)]),t("section",ee,[t("div",te,[t("div",oe,[w.value?(r(),s(i,{key:0},[e[12]||(e[12]=t("div",{class:"h-28 animate-pulse rounded-3xl bg-muted/50"},null,-1)),e[13]||(e[13]=t("div",{class:"h-24 animate-pulse rounded-3xl bg-muted/50"},null,-1))],64)):(r(),s(i,{key:1},[C.value.length?(r(!0),s(i,{key:0},A(C.value,o=>(r(),s("div",{key:o.id||o.timestamp,class:_(["rounded-2xl border px-4 py-4 shadow-sm",o.role==="assistant"?"border-border/70 bg-background/90":"border-transparent bg-primary/5 text-primary"])},[t("p",se,[m(a(o.role==="assistant"?"Recommendation engine":"You")+" ",1),t("span",re,a(o.timestamp??""),1)]),t("div",le,[o.title?(r(),s("p",ae,a(o.title),1)):d("",!0),Array.isArray(o.content)?(r(),s("ul",ne,[(r(!0),s(i,null,A(o.content,(j,O)=>(r(),s("li",{key:O,class:"rounded-xl bg-muted/40 px-3 py-2 text-muted-foreground"},a(j),1))),128))])):o.content?(r(),s("p",de,a(o.content),1)):d("",!0),!o.content&&!Array.isArray(o.content)?(r(),s("p",ie," No details recorded. ")):d("",!0)])],2))),128)):(r(),s("div",ue," No project activity yet. Once the recommendation engine generates travel suggestions, they will be summarized here. "))],64))])]),t("div",ce,[t("div",me,[b(y(p),{variant:"outline",size:"icon",class:"shrink-0",onClick:e[0]||(e[0]=o=>c.value=!0),"aria-label":"Attach travel documents"},{default:g(()=>[...e[14]||(e[14]=[t("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"size-4"},[t("path",{"fill-rule":"evenodd",d:"M10 3.25a.75.75 0 01.75.75v5.25H16a.75.75 0 010 1.5h-5.25V16a.75.75 0 01-1.5 0v-5.25H4a.75.75 0 010-1.5h5.25V4a.75.75 0 01.75-.75z","clip-rule":"evenodd"})],-1)])]),_:1}),e[16]||(e[16]=t("textarea",{class:"h-20 flex-1 resize-none bg-transparent text-sm text-foreground placeholder:text-muted-foreground focus:outline-none",placeholder:"Describe a traveler and preferences to see how the project would generate recommendations...",disabled:""},null,-1)),b(y(p),{variant:"outline",disabled:""},{default:g(()=>[...e[15]||(e[15]=[m("Coming soon",-1)])]),_:1})]),e[17]||(e[17]=t("p",{class:"mt-2 text-center text-xs text-muted-foreground"}," Recommendations are indicative onlyâ€”always verify travel details (flights, visas, restrictions) before booking. ",-1)),f.value.value?(r(),s("div",fe,a(f.value.value),1)):d("",!0)]),c.value?(r(),s("div",xe,[t("div",ve,[t("div",pe,[e[19]||(e[19]=t("div",null,[t("h2",{class:"text-base font-semibold text-foreground"},"Attach travel documents"),t("p",{class:"mt-1 text-xs text-muted-foreground"}," Upload tickets or invoices related to this trip. ")],-1)),t("button",{class:"rounded-full p-1 text-muted-foreground hover:bg-muted",onClick:e[1]||(e[1]=o=>c.value=!1),"aria-label":"Close"},[...e[18]||(e[18]=[t("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"size-4"},[t("path",{"fill-rule":"evenodd",d:"M5.22 5.22a.75.75 0 011.06 0L10 8.94l3.72-3.72a.75.75 0 111.06 1.06L11.06 10l3.72 3.72a.75.75 0 11-1.06 1.06L10 11.06l-3.72 3.72a.75.75 0 11-1.06-1.06L8.94 10 5.22 6.28a.75.75 0 010-1.06z","clip-rule":"evenodd"})],-1)])])]),t("div",be,[b(y(p),{variant:"outline",class:"w-full justify-start",onClick:e[2]||(e[2]=o=>c.value=!1)},{default:g(()=>[...e[20]||(e[20]=[m(" Upload airplane ticket ",-1)])]),_:1}),b(y(p),{variant:"outline",class:"w-full justify-start",onClick:e[3]||(e[3]=o=>c.value=!1)},{default:g(()=>[...e[21]||(e[21]=[m(" Upload accomodation invoice ",-1)])]),_:1}),b(y(p),{variant:"outline",class:"w-full justify-start",onClick:e[4]||(e[4]=o=>c.value=!1)},{default:g(()=>[...e[22]||(e[22]=[m(" Upload other document ",-1)])]),_:1})]),e[23]||(e[23]=t("p",{class:"mt-3 text-[11px] text-muted-foreground"}," Uploading is not yet implemented in this prototype. ",-1))])])):d("",!0)])])]))}};export{he as default};
