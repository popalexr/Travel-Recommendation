import{_ as D}from"./index.js";import{r as l,c as L,w as O,y as S,A as r,K as e,F as d,B as u,C as y,R as n,N as v,Q as _,s as R,q as U,v as z,l as s}from"./main.js";const P={class:"flex h-screen bg-background text-foreground"},V={class:"hidden h-full w-72 flex-col border-r border-border/60 bg-muted/30 px-4 py-6 md:flex"},E={class:"mt-6 flex-1 space-y-2 overflow-y-auto pr-2"},F=["onClick"],$={class:"text-sm font-medium leading-tight"},q={key:0,class:"text-xs text-muted-foreground/80"},I={class:"border-t border-border/50 pt-4"},K={class:"relative"},Q={key:0,class:"absolute bottom-14 left-0 w-full rounded-xl border border-border/50 bg-background/95 shadow-lg backdrop-blur"},Y=["disabled"],G={class:"flex flex-1 flex-col overflow-hidden bg-background"},H={class:"border-b border-border/60 bg-background/80 px-6 py-5 backdrop-blur lg:px-10"},J={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between"},W={class:"flex items-center gap-2 text-xs text-muted-foreground"},X={key:0,class:"mt-3 text-xs text-destructive"},Z={class:"relative flex flex-1 flex-col overflow-hidden"},ee={class:"flex-1 overflow-y-auto px-6 py-6 lg:px-10"},te={class:"mx-auto w-full max-w-4xl space-y-6"},oe={class:"text-xs uppercase tracking-[0.3em] text-muted-foreground/80"},re={class:"ml-2 text-muted-foreground/60"},se={class:"mt-3 space-y-3 text-sm leading-relaxed"},ae={key:0,class:"text-sm font-semibold text-foreground"},ne={key:1,class:"space-y-3"},le={key:2,class:"text-muted-foreground"},de={key:3,class:"text-muted-foreground/70"},ue={key:1,class:"rounded-2xl border border-dashed border-border/70 px-4 py-10 text-center text-sm text-muted-foreground"},ie={class:"border-t border-border/60 bg-background/95 px-6 py-5 lg:px-10"},ce={class:"mx-auto flex w-full max-w-4xl items-end gap-3 rounded-2xl border border-border/70 bg-background/80 px-4 py-3 shadow-sm"},xe={key:0,class:"mx-auto mt-3 w-full max-w-4xl rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive"},pe={__name:"Dashboard",props:{user:{type:Object,default:()=>({})}},setup(k){const w=k,f=l(!1),c=l(""),x=l(!1),i=l(null),p=l([]),g=l([]),m=l(""),b=l(!0),A=L(()=>{const{firstName:a,lastName:t,email:o}=w.user??{};return a||t?[a,t].filter(Boolean).join(" ").trim()||"Traveler":o??"Traveler"});O(p,a=>{if(!a||a.length===0){i.value=null;return}a.find(o=>o.id===i.value)||(i.value=a[0]?.id??null)},{immediate:!0});async function N(){b.value=!0,m.value="";try{const a=await fetch("/api/dashboard",{credentials:"same-origin"});if(!a.ok){m.value="Unable to fetch dashboard data.";return}const t=await a.json().catch(()=>({}));p.value=Array.isArray(t.previousRecommendations)?t.previousRecommendations:[],g.value=Array.isArray(t.chatMessages)?t.chatMessages:[]}catch{m.value="Unexpected error loading dashboard."}finally{b.value=!1}}S(()=>{N()});function C(){x.value=!x.value}function T(){x.value=!1}function j(){T(),window.location.href="/settings"}async function M(){if(!f.value){c.value="",f.value=!0;try{const a=await fetch("/logout",{method:"POST",credentials:"same-origin"}),t=await a.json().catch(()=>({}));if(!a.ok){c.value=t?.message??"Unable to log out.";return}window.location.href="/"}catch{c.value="Unexpected error. Please try again."}finally{f.value=!1}}}return(a,t)=>(s(),r("div",P,[e("aside",V,[t[4]||(t[4]=e("div",null,[e("p",{class:"text-xs uppercase tracking-[0.4em] text-muted-foreground"},"Trips"),e("h2",{class:"mt-2 font-semibold text-foreground"},"Previous recommendations")],-1)),e("nav",E,[b.value?(s(),r(d,{key:0},[t[0]||(t[0]=e("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1)),t[1]||(t[1]=e("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1)),t[2]||(t[2]=e("div",{class:"h-14 animate-pulse rounded-xl bg-muted/60"},null,-1))],64)):(s(),r(d,{key:1},[(s(!0),r(d,null,y(p.value,o=>(s(),r("button",{key:o.id||o.title,onClick:h=>i.value=o.id,class:v(["w-full rounded-xl px-3 py-3 text-left transition-all",i.value===o.id?"bg-primary text-primary-foreground shadow-sm":"bg-background/80 text-muted-foreground hover:bg-muted/60 hover:text-foreground"])},[e("p",$,n(o.title??"Untitled"),1),e("p",{class:v(["mt-1 text-xs",i.value===o.id?"text-primary-foreground/80":"text-muted-foreground/80"])},n(o.subtitle??"No metadata available"),3)],10,F))),128)),p.value.length?u("",!0):(s(),r("p",q," No recommendations yet. They will appear here once generated. "))],64))]),e("div",I,[e("div",K,[e("button",{class:"flex w-full items-center justify-between rounded-xl bg-background/80 px-3 py-3 text-sm font-medium text-foreground transition hover:bg-muted",onClick:C},[e("span",null,n(A.value),1),(s(),r("svg",{class:v(["size-4 text-muted-foreground transition-transform",x.value?"rotate-180":""]),viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[...t[3]||(t[3]=[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"},null,-1)])],2))]),x.value?(s(),r("div",Q,[e("button",{class:"w-full px-4 py-2 text-left text-sm text-muted-foreground hover:bg-muted/70 hover:text-foreground",onClick:j}," Settings "),e("button",{class:"w-full px-4 py-2 text-left text-sm text-destructive hover:bg-destructive/10",onClick:M,disabled:f.value}," Sign out ",8,Y)])):u("",!0)])])]),e("main",G,[e("header",H,[e("div",J,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-xl font-semibold tracking-tight sm:text-2xl"}," Project companion "),e("p",{class:"text-sm text-muted-foreground"}," Based on the Travel Recommendation documentation. ")],-1)),e("div",W,[t[5]||(t[5]=e("span",{class:"rounded-full bg-emerald-500/10 px-2 py-1 text-emerald-500"},"Online",-1)),_(" "+n(new Date().toLocaleDateString()),1)])]),m.value?(s(),r("p",X,n(m.value),1)):u("",!0)]),e("section",Z,[e("div",ee,[e("div",te,[b.value?(s(),r(d,{key:0},[t[7]||(t[7]=e("div",{class:"h-28 animate-pulse rounded-3xl bg-muted/50"},null,-1)),t[8]||(t[8]=e("div",{class:"h-24 animate-pulse rounded-3xl bg-muted/50"},null,-1))],64)):(s(),r(d,{key:1},[g.value.length?(s(!0),r(d,{key:0},y(g.value,o=>(s(),r("div",{key:o.id||o.timestamp,class:v(["rounded-2xl border px-4 py-4 shadow-sm",o.role==="assistant"?"border-border/70 bg-background/90":"border-transparent bg-primary/5 text-primary"])},[e("p",oe,[_(n(o.role==="assistant"?"Assistant":"You")+" ",1),e("span",re,n(o.timestamp??""),1)]),e("div",se,[o.title?(s(),r("p",ae,n(o.title),1)):u("",!0),Array.isArray(o.content)?(s(),r("ul",ne,[(s(!0),r(d,null,y(o.content,(h,B)=>(s(),r("li",{key:B,class:"rounded-xl bg-muted/40 px-3 py-2 text-muted-foreground"},n(h),1))),128))])):o.content?(s(),r("p",le,n(o.content),1)):u("",!0),!o.content&&!Array.isArray(o.content)?(s(),r("p",de," No details recorded. ")):u("",!0)])],2))),128)):(s(),r("div",ue," No conversation yet. Once the assistant generates recommendations, they will appear here. "))],64))])]),e("div",ie,[e("div",ce,[t[10]||(t[10]=e("textarea",{class:"h-20 flex-1 resize-none bg-transparent text-sm text-foreground placeholder:text-muted-foreground focus:outline-none",placeholder:"Ask about the project documentation...",disabled:""},null,-1)),R(z(D),{variant:"outline",disabled:""},{default:U(()=>[...t[9]||(t[9]=[_("Coming soon",-1)])]),_:1})]),t[11]||(t[11]=e("p",{class:"mt-2 text-center text-xs text-muted-foreground"}," Information may be inaccurate or outdatedâ€”verify with reliable sources before making decisions. ",-1)),c.value.value?(s(),r("div",xe,n(c.value.value),1)):u("",!0)])])])]))}};export{pe as default};
