import{_ as P}from"./index.js";import{c as N,_ as C,a as U,b as M,d as j,e as O}from"./createLucideIcon.js";import{_ as f,c as v}from"./Label.js";import{r as u,K as $,w as L,T as B,z as y,J as t,q as s,s as a,l as r,L as d,M as c,A as z,k as w}from"./main.js";/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=N("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=N("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=N("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=N("sliders-horizontal",[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]]),I={class:"relative min-h-screen overflow-hidden bg-background text-foreground"},G={class:"relative border-b border-border/60 bg-background/80 backdrop-blur"},Q={class:"mx-auto flex max-w-6xl flex-col gap-4 px-6 py-6 md:flex-row md:items-center md:justify-between md:px-8"},W={class:"flex items-center gap-4"},X={class:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/10 text-primary"},Y={class:"flex flex-wrap items-center gap-3"},Z={href:"/dashboard"},ee={class:"relative mx-auto w-full max-w-6xl px-6 py-10 md:px-8"},se={key:0,class:"mb-6 rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive"},ae={class:"grid gap-6 lg:grid-cols-2"},te={class:"space-y-6"},re={class:"flex items-center gap-2 text-primary"},oe={key:0,class:"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive"},le={key:1,class:"rounded-md border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-600"},de={class:"grid gap-4 sm:grid-cols-2"},ie={class:"space-y-2"},ne={class:"space-y-2"},ue={class:"space-y-2"},ce={class:"flex flex-wrap items-center justify-end gap-3"},pe={class:"space-y-6"},me={class:"flex items-center gap-2 text-primary"},fe={key:0,class:"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-sm text-destructive"},ve={key:1,class:"rounded-md border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-600"},ye={class:"space-y-2"},we={class:"grid gap-4 sm:grid-cols-2"},ge={class:"space-y-2"},xe={class:"space-y-2"},be={class:"flex flex-wrap items-center justify-between gap-3 text-xs text-muted-foreground"},_e={class:"flex items-center gap-2"},Ve={__name:"Settings",props:{user:{type:Object,default:()=>({})}},setup(q){const V=q,g=u(!1),x=u(""),o=$({firstName:"",lastName:"",email:""}),b=u(!1),m=u(""),_=u(""),i=$({currentPassword:"",newPassword:"",confirmPassword:""}),h=u(!1),p=u(""),S=u("");L(()=>V.user,l=>{o.firstName=l?.firstName??"",o.lastName=l?.lastName??"",o.email=l?.email??""},{immediate:!0});function H(){o.firstName=V.user?.firstName??"",o.lastName=V.user?.lastName??"",o.email=V.user?.email??"",m.value="",_.value=""}async function T(){if(!b.value){b.value=!0,m.value="",_.value="";try{const l=await fetch("/api/settings/profile",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:o.firstName,lastName:o.lastName})}),e=await l.json().catch(()=>({}));if(!l.ok){m.value=e?.error??"Unable to update profile.";return}const k=e?.profile??{};o.firstName=k.firstName??"",o.lastName=k.lastName??"",o.email=k.email??o.email,_.value="Profile updated."}catch{m.value="Unexpected error updating profile."}finally{b.value=!1}}}async function A(){if(!h.value){if(p.value="",S.value="",!i.currentPassword||!i.newPassword){p.value="Current and new passwords are required.";return}if(i.newPassword!==i.confirmPassword){p.value="New passwords do not match.";return}h.value=!0;try{const l=await fetch("/api/settings/password",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:i.currentPassword,newPassword:i.newPassword})}),e=await l.json().catch(()=>({}));if(!l.ok){p.value=e?.error??"Unable to update password.";return}i.currentPassword="",i.newPassword="",i.confirmPassword="",S.value=e?.message??"Password updated."}catch{p.value="Unexpected error updating password."}finally{h.value=!1}}}async function E(){if(!g.value){x.value="",g.value=!0;try{const l=await fetch("/logout",{method:"POST",credentials:"same-origin"}),e=await l.json().catch(()=>({}));if(!l.ok){x.value=e?.message??"Unable to log out.";return}window.location.href="/"}catch{x.value="Unexpected error. Please try again."}finally{g.value=!1}}}return(l,e)=>{const k=B("ShieldCheck");return w(),y("div",I,[e[20]||(e[20]=t("div",{class:"pointer-events-none absolute inset-x-0 top-0 h-44 bg-gradient-to-b from-primary/25 via-primary/10 to-transparent blur-3xl"},null,-1)),e[21]||(e[21]=t("div",{class:"pointer-events-none absolute -bottom-24 right-0 h-56 w-56 rounded-full bg-secondary/30 blur-3xl"},null,-1)),t("header",G,[t("div",Q,[t("div",W,[t("div",X,[s(a(D),{class:"size-5"})]),e[6]||(e[6]=t("div",null,[t("p",{class:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground"}," Settings "),t("h1",{class:"text-2xl font-semibold tracking-tight sm:text-3xl"}," Account and experience controls "),t("p",{class:"text-sm text-muted-foreground"}," Review your profile, security, and trip defaults in one place. ")],-1))]),t("div",Y,[s(a(P),{variant:"outline",size:"sm",class:"gap-2","as-child":""},{default:r(()=>[t("a",Z,[s(a(F),{class:"size-4"}),e[7]||(e[7]=d(" Back to dashboard ",-1))])]),_:1}),s(a(P),{variant:"ghost",size:"sm",class:"gap-2",disabled:g.value,onClick:E},{default:r(()=>[s(a(K),{class:"size-4"}),d(" "+c(g.value?"Signing out...":"Sign out"),1)]),_:1},8,["disabled"])])])]),t("main",ee,[x.value?(w(),y("div",se,c(x.value),1)):z("",!0),t("div",ae,[t("section",te,[s(a(O),{class:"border border-border/70 bg-background/80"},{default:r(()=>[s(a(C),{class:"space-y-2"},{default:r(()=>[t("div",re,[s(a(R),{class:"size-4"}),s(a(U),{class:"text-xl"},{default:r(()=>[...e[8]||(e[8]=[d("Profile details",-1)])]),_:1})]),s(a(M),null,{default:r(()=>[...e[9]||(e[9]=[d(" Update your name and verify the email used for authentication. ",-1)])]),_:1})]),_:1}),s(a(j),{class:"space-y-4"},{default:r(()=>[m.value?(w(),y("div",oe,c(m.value),1)):_.value?(w(),y("div",le,c(_.value),1)):z("",!0),t("div",de,[t("div",ie,[s(a(f),{for:"first-name"},{default:r(()=>[...e[10]||(e[10]=[d("First name",-1)])]),_:1}),s(a(v),{id:"first-name",modelValue:o.firstName,"onUpdate:modelValue":e[0]||(e[0]=n=>o.firstName=n),placeholder:"Avery"},null,8,["modelValue"])]),t("div",ne,[s(a(f),{for:"last-name"},{default:r(()=>[...e[11]||(e[11]=[d("Last name",-1)])]),_:1}),s(a(v),{id:"last-name",modelValue:o.lastName,"onUpdate:modelValue":e[1]||(e[1]=n=>o.lastName=n),placeholder:"Stone"},null,8,["modelValue"])])]),t("div",ue,[s(a(f),{for:"profile-email"},{default:r(()=>[...e[12]||(e[12]=[d("Email",-1)])]),_:1}),s(a(v),{id:"profile-email",type:"email",modelValue:o.email,"onUpdate:modelValue":e[2]||(e[2]=n=>o.email=n),disabled:"",class:"bg-muted/40"},null,8,["modelValue"])]),t("div",ce,[s(a(P),{variant:"ghost",size:"sm",onClick:H},{default:r(()=>[...e[13]||(e[13]=[d(" Reset ",-1)])]),_:1}),s(a(P),{size:"sm",class:"gap-2",disabled:b.value,onClick:T},{default:r(()=>[d(c(b.value?"Saving...":"Save changes"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})]),t("section",pe,[s(a(O),{class:"border border-border/70 bg-background/80"},{default:r(()=>[s(a(C),{class:"space-y-2"},{default:r(()=>[t("div",me,[s(a(J),{class:"size-4"}),s(a(U),{class:"text-xl"},{default:r(()=>[...e[14]||(e[14]=[d("Security",-1)])]),_:1})]),s(a(M),null,{default:r(()=>[...e[15]||(e[15]=[d(" Change your password to keep access secure. ",-1)])]),_:1})]),_:1}),s(a(j),{class:"space-y-4"},{default:r(()=>[p.value?(w(),y("div",fe,c(p.value),1)):S.value?(w(),y("div",ve,c(S.value),1)):z("",!0),t("div",ye,[s(a(f),{for:"current-password"},{default:r(()=>[...e[16]||(e[16]=[d("Current password",-1)])]),_:1}),s(a(v),{id:"current-password",type:"password",modelValue:i.currentPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>i.currentPassword=n),placeholder:"Enter current password"},null,8,["modelValue"])]),t("div",we,[t("div",ge,[s(a(f),{for:"new-password"},{default:r(()=>[...e[17]||(e[17]=[d("New password",-1)])]),_:1}),s(a(v),{id:"new-password",type:"password",modelValue:i.newPassword,"onUpdate:modelValue":e[4]||(e[4]=n=>i.newPassword=n),placeholder:"At least 8 characters"},null,8,["modelValue"])]),t("div",xe,[s(a(f),{for:"confirm-password"},{default:r(()=>[...e[18]||(e[18]=[d("Confirm new password",-1)])]),_:1}),s(a(v),{id:"confirm-password",type:"password",modelValue:i.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=n=>i.confirmPassword=n),placeholder:"Repeat new password"},null,8,["modelValue"])])]),t("div",be,[t("div",_e,[s(k,{class:"size-4 text-primary"}),e[19]||(e[19]=d(" Use a mix of letters, numbers, and symbols. ",-1))]),s(a(P),{size:"sm",class:"gap-2",disabled:h.value,onClick:A},{default:r(()=>[d(c(h.value?"Updating...":"Update password"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})])])])])}}};export{Ve as default};
